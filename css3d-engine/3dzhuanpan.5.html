<!DOCTYPE html>
<html lang="en">
<head>
    <!--适配-->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width,minimum-scale=1,user-scalable=no,maximum-scale=1,initial-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="format-detection" content="telephone=no">  
	<meta http-equiv="x-rim-auto-match" content="none">  
    <!--适配-->
    <!--通用-->
    <style>
            *,
        ::before,
        ::after {
        padding: 0;
        margin: 0;
        -webkit-tap-highlight-color: transparent;
        -webkit-box-sizing: border-box;
        box-sizing: border-box; }
        html,body {
            width: 100%;
            height: 100%;
        }
        #main {
            width: 100%;
            height: 100%;
            background-size: 100% 100%;
        }
        .redmask {
            height: 100%;
            position: absolute;
            top: 0;
            right: 0;
            width: 0.2rem;
            background: #aa0117;
        }
        .redmask-L {
            height: 100%;
            width: 0.2rem;
            background: #aa0117;
        }
        #startBtn {
            width: 1.875rem;
            height: 2.675rem;
            position: fixed;
            left: 50%;
            bottom: 2rem;
            margin-left: -1.25rem;
            z-index: 100;
            background: url("./images/dazhuanpan/other-click.png") no-repeat;
            background-size: 100% 100%; 
        }
        #tip {
            width: 4.6rem;
            height: 1rem;
            line-height: 1rem;
            position: absolute;
            bottom: -1.1rem;
            left: 50%;
            font-size: 0.5rem;
            margin-left: -2.3rem;
            text-align: center;
            color: #ffffff;
            background: black;
            opacity: 0.5;
            letter-spacing: 0.1rem;
            transform: scale(0.8,0.8);
        }
    </style>
    <!--通用-->
    <title>css3d-engine</title>
</head>
<body>
    <div id="main"></div>
    <div id="startBtn" class="disable">
        <p id="tip">点击开始转动</p>
    </div>
    <!--=========-->
    <!--js begine-->
    <!--=========-->
    <script src="./js/jquery.js"></script>
    <script src="./js/css3d.js"></script>
    <script src="./js/jstween.min.js"></script>
    <script src="./js/hammer.min.js"></script>
    <script>
        // @e-mail：tumi330@163.com
        // 适配：640的设计稿，320的屏
        ;(function (doc, win) {
            var docEl = doc.documentElement,
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
                    recalc = function () {
                var clientWidth = docEl.clientWidth;
                if (!clientWidth) return;
                if(clientWidth > 800) clientWidth=800;
                docEl.style.fontSize = 20 * (clientWidth / 320) + 'px';
            };
            
            if (!doc.addEventListener) return;
            win.addEventListener(resizeEvt, recalc, false);
            recalc();
        })(document, window);

        ;(function(){
            // 【开始游戏按钮事件】
            $("#startBtn").on("click",function(){
                if(G.lock_startBtn){
                    doLotteryAnimation();
                    // 模拟请求抽奖的结果  success函数返回
                    var moniawardName = "恭喜你获得一等奖，奖品是iphone6";
                    var monitrophyName = "一等奖";
                    // 回填中奖信息
                    G.result.isNull =  false;
                    G.result.awardName =  moniawardName;
                    G.result.trophyName =  monitrophyName;
                    G.lock_startBtn = false;
                }
            });
            // 上下文(type:1/中奖 2/没中奖 3/有图的空白框 4/没图的空白框)
            var content = [
                {
                    "id":1,
                    "type":1,
                    "frameUrl":"./images/dazhuanpan/get-1.png",
                    "textUrl":"./images/dazhuanpan/get-text1.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)",
                    "giftUrl":"./images/dazhuanpan/gift-1.png"
                },
                {
                    "id":2,
                    "type":1,
                    "frameUrl":"./images/dazhuanpan/get-2.png",
                    "textUrl":"./images/dazhuanpan/get-text2.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)",
                    "giftUrl":"./images/dazhuanpan/gift-1.png"
                },
                {
                    "id":3,
                    "type":1,
                    "frameUrl":"./images/dazhuanpan/get-3.png",
                    "textUrl":"./images/dazhuanpan/get-text3.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)",
                    "giftUrl":"./images/dazhuanpan/gift-1.png"
                },
                {
                    "id":4,
                    "type":1,
                    "frameUrl":"./images/dazhuanpan/get-4.png",
                    "textUrl":"./images/dazhuanpan/get-text4.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)",
                    "giftUrl":"./images/dazhuanpan/gift-1.png"
                },
                {
                    "id":5,
                    "type":1,
                    "frameUrl":"./images/dazhuanpan/get-5.png",
                    "textUrl":"./images/dazhuanpan/get-text5.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)",
                    "giftUrl":"./images/dazhuanpan/gift-2.png"
                },
                {
                    "id":6,
                    "type":2,
                    "frameUrl":"./images/dazhuanpan/noGet-1.png",
                    "textUrl":"./images/dazhuanpan/noGet-text1.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)"
                },
                {
                    "id":7,
                    "type":2,
                    "frameUrl":"./images/dazhuanpan/noGet-2.png",
                    "textUrl":"./images/dazhuanpan/noGet-text2.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)"
                },
                {
                    "id":8,
                    "type":2,
                    "frameUrl":"./images/dazhuanpan/noGet-3.png",
                    "textUrl":"./images/dazhuanpan/noGet-text3.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)"
                },
                {
                    "id":9,
                    "type":2,
                    "frameUrl":"./images/dazhuanpan/noGet-4.png",
                    "textUrl":"./images/dazhuanpan/noGet-text4.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)"
                },
                {
                    "id":10,
                    "type":2,
                    "frameUrl":"./images/dazhuanpan/noGet-5.png",
                    "textUrl":"./images/dazhuanpan/noGet-text5.png",
                    "text":"(Apple iPhone 7 (A1660) 32G 金色移动联通电信4G手机)"
                },
                {
                    "id":11,
                    "type":3,
                    "frameUrl":"./images/dazhuanpan/noEmpty-1.png",
                    "textUrl":"",
                    "text":""
                },
                {
                    "id":12,
                    "type":3,
                    "frameUrl":"./images/dazhuanpan/noEmpty-2.png",
                    "textUrl":"",
                    "text":""
                },
                {
                    "id":13,
                    "type":3,
                    "frameUrl":"./images/dazhuanpan/noEmpty-3.png",
                    "textUrl":"",
                    "text":""
                },
                {
                    "id":14,
                    "type":3,
                    "frameUrl":"./images/dazhuanpan/noEmpty-4.png",
                    "textUrl":"",
                    "text":""
                },
                {
                    "id":15,
                    "type":4,
                    "frameUrl":"./images/dazhuanpan/empty-1.png",
                    "textUrl":"",
                    "text":""
                },
                {
                    "id":16,
                    "type":4,
                    "frameUrl":"./images/dazhuanpan/empty-2.png",
                    "textUrl":"",
                    "text":""
                },
            ];
            // 中奖的8个页面
            var getArr = [];// 5
            var noGetArr = [];// 5
            var noEmptyArr = [];// 4
            var emptyArr = [];// 2
            for (var i=0 ; i<content.length ; i++) {
                if(content[i].type == 1){
                    getArr.push(content[i]);
                }else if(content[i].type == 2) {
                    noGetArr.push(content[i]);
                }else if(content[i].type == 3){
                    noEmptyArr.push(content[i]);
                }else {
                    emptyArr.push(content[i]);
                }
            }
            // TODO 分奖项级别 拿到奖项名字 给页面赋值
            // var awardText = ["12313","123","21124"];
            // for(var i=0 ; i<getArr.length ; i++){
            //     getArr[i] = awardText[Math.floor(3*Math.random)];
            // }
            // 全局配置
            var G = {
                // 奖项
                "award":{
                    "num":3
                },
                "planes":[],
                "Sprites1":[],
                "Sprites2":[],
                "Sprites3":[],
                // 锁-锁住游戏进程(false代表锁住，不执行)
                "lock_startGame":false,
                // 锁-锁住开始动画（false代表锁住，不执行）
                "lock_startAnimation":true,
                // 锁-锁住开始游戏的按钮(false代表锁住，不执行)
                "lock_startBtn":true,
                // 值-抽奖结果
                "result":{
                    // 是否拿到返回值
                    "isNull":true,
                    // 奖项名
                    "trophyName":"",
                    // 奖品名
                    "awardName":""
                }
            };
            // 页面构建
            var planeData1 = [
                {'id':1,
                 'angle':10,
                 'bgUrl':getArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':2,
                 'angle':20,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':3,
                 'angle':30,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':4,
                 'angle':40,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':5,
                 'angle':50,
                 'bgUrl':noEmptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':6,
                 'angle':60,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':7,
                 'angle':70,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':8,
                 'angle':80,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':9,
                 'angle':90,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':10,
                 'angle':100,
                 'bgUrl':getArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':11,
                 'angle':110,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':12,
                 'angle':120,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':13,
                 'angle':130,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':14,
                 'angle':140,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':15,
                 'angle':150,
                 'bgUrl':noEmptyArr[3].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':16,
                 'angle':160,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':17,
                 'angle':170,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':18,
                 'angle':180,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':19,
                 'angle':190,
                 'bgUrl':getArr[2].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':20,
                 'angle':200,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':21,
                 'angle':210,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':22,
                 'angle':220,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':23,
                 'angle':230,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':24,
                 'angle':240,
                 'bgUrl':noEmptyArr[2].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':25,
                 'angle':250,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':26,
                 'angle':260,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':27,
                 'angle':270,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':28,
                 'angle':280,
                 'bgUrl':getArr[3].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':29,
                 'angle':290,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':30,
                 'angle':300,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':31,
                 'angle':310,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':32,
                 'angle':320,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':33,
                 'angle':330,
                 'bgUrl':noEmptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':34,
                 'angle':340,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':35,
                 'angle':350,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':36,
                 'angle':360,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
            ];
            var planeData2 = [
                {'id':1,
                 'angle':10,
                 'bgUrl':noGetArr[2].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':2,
                 'angle':20,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':3,
                 'angle':30,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':4,
                 'angle':40,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':5,
                 'angle':50,
                 'bgUrl':noEmptyArr[3].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':6,
                 'angle':60,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':7,
                 'angle':70,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':8,
                 'angle':80,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':9,
                 'angle':90,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':10,
                 'angle':100,
                 'bgUrl':noGetArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':11,
                 'angle':110,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':12,
                 'angle':120,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':13,
                 'angle':130,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':14,
                 'angle':140,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':15,
                 'angle':150,
                 'bgUrl':noEmptyArr[2].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':16,
                 'angle':160,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':17,
                 'angle':170,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':18,
                 'angle':180,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':19,
                 'angle':190,
                 'bgUrl':noGetArr[3].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':20,
                 'angle':200,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':21,
                 'angle':210,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':22,
                 'angle':220,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':23,
                 'angle':230,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':24,
                 'angle':240,
                 'bgUrl':noEmptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':25,
                 'angle':250,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':26,
                 'angle':260,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':27,
                 'angle':270,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':28,
                 'angle':280,
                 'bgUrl':getArr[4].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':29,
                 'angle':290,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':30,
                 'angle':300,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':31,
                 'angle':310,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':32,
                 'angle':320,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':33,
                 'angle':330,
                 'bgUrl':noEmptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':34,
                 'angle':340,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':35,
                 'angle':350,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':36,
                 'angle':360,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
            ];
            // 第三组素材里面的第一组画面是抽奖结果(随机配置第三组素材)
             var planeData3 = [
                 {'id':1,
                 'angle':10,
                 'bgUrl':getArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':2,
                 'angle':20,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':3,
                 'angle':30,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':4,
                 'angle':40,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':5,
                 'angle':50,
                 'bgUrl':noEmptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':6,
                 'angle':60,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':7,
                 'angle':70,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':8,
                 'angle':80,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':9,
                 'angle':90,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':10,
                 'angle':100,
                 'bgUrl':getArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':11,
                 'angle':110,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':12,
                 'angle':120,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':13,
                 'angle':130,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':14,
                 'angle':140,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':15,
                 'angle':150,
                 'bgUrl':noEmptyArr[3].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':16,
                 'angle':160,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':17,
                 'angle':170,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':18,
                 'angle':180,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':19,
                 'angle':190,
                 'bgUrl':getArr[2].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':20,
                 'angle':200,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':21,
                 'angle':210,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':22,
                 'angle':220,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':23,
                 'angle':230,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':24,
                 'angle':240,
                 'bgUrl':noEmptyArr[2].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':25,
                 'angle':250,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':26,
                 'angle':260,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':27,
                 'angle':270,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':28,
                 'angle':280,
                 'bgUrl':getArr[3].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':29,
                 'angle':290,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':30,
                 'angle':300,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':31,
                 'angle':310,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':32,
                 'angle':320,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':33,
                 'angle':330,
                 'bgUrl':noEmptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':34,
                 'angle':340,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':35,
                 'angle':350,
                 'bgUrl':emptyArr[0].frameUrl,
                 'textUrl':"",
                 'text':""
                },
                {'id':36,
                 'angle':360,
                 'bgUrl':emptyArr[1].frameUrl,
                 'textUrl':"",
                 'text':""
                },
            ];
            // 缓存
            var cache = {
                set: function(key, value) {
                    var current = this.get() || {};
                    current[key] = value;
                    G.store.push(current);
                },
                get: function(key) {
                    for(var i=0;i<G.store.length;i++){
                        for(var key_i in G.store[i]){
                            if(key_i == key){
                                return G.store[i][key];
                            }
                        }
                    }
                }
            };
            // 运用css3dengine的示例
            // 创建场景
            // 所有的函数都能够链式调用
            // 一般在创建元素的时候都要调用update() 
            // 分别会执行updateS(),updateM(),updateT(),updateV()
            var sence = new C3D.Stage();
            sence.camera.position(10*window.innerWidth/32,5*window.innerWidth/32,-7*window.innerWidth/32).rotation(0,23,0);
            sence.camera.fov = 75;
            sence.size(window.innerWidth,window.innerHeight).material(
                {
                    image:"./images/dazhuanpan/bg.png",
                    size:"100% 100%"
                }
            ).update();
            // 最后将stage的dom元素置入到所需位置
            // el是所有元素的三维属性，包含对应的dom元素
            document.getElementById('main').appendChild(sence.el);
            
            //循环创建第一组平面
            function createPlane(imgs) {
                var _len = imgs.length;

                for( i=0 ; i<_len ; i++){
                    var _p = new C3D.Plane();
                    var _sp = new C3D.Sprite();
                    _p.size(window.innerWidth,window.innerHeight).rotation(0,imgs[i].angle,0).origin(window.innerWidth,window.innerWidth/2,0).position(window.innerWidth/2,-37*window.innerWidth/96,-sence.fov).material({
                        image:imgs[i].bgUrl,
                        size:"80% 100%",
                        position:"left bottom",
                        repeat:"no-repeat"
                    }).update();
                    _p.property={
                        "id": i,
                        "row": "01"
                    };
                    G.planes.push(_p);
                    _sp.addChild(_p);
                    G.Sprites1.push(_sp);
                }
                return G.Sprites1;
            }
            var Sprites1 = createPlane(planeData1);
           
            for(var i=0; i<Sprites1.length; i++){
                sence.addChild(Sprites1[i]);
            }

             //循环创建第二组平面
            function createPlane2(imgs) {
                var _len = imgs.length;

                for( i=0 ; i<_len ; i++){
                    var _p = new C3D.Plane();
                    var _sp = new C3D.Sprite();
                    _p.size(window.innerWidth,window.innerHeight).rotation(0,imgs[i].angle,0).origin(window.innerWidth,window.innerWidth/2,0).position(window.innerWidth/2,-37*window.innerWidth/96,-sence.fov).material({
                        image:imgs[i].bgUrl,
                        size:"80% 100%",
                        position:"left bottom",
                        repeat:"no-repeat"
                    }).update();
                    _p.property={
                        "id": i,
                        "row": "02"
                    };
                    G.planes.push(_p);
                    _sp.addChild(_p);
                    G.Sprites2.push(_sp);
                }
                return G.Sprites2;
            }   
            var Sprites2 = createPlane2(planeData2);
           
            for(var i=0; i<Sprites2.length; i++){
                sence.addChild(Sprites2[i]);
            }

            // 循环创建第三组平面
            function createPlane3(imgs) {
                var _len = imgs.length;

                for( var i=0 ; i<_len ; i++){
                    var _p = new C3D.Plane();
                    var _sp = new C3D.Sprite();
                     _p.size(window.innerWidth,window.innerHeight).rotation(0,imgs[i].angle,0).origin(window.innerWidth,window.innerWidth/2,0).position(window.innerWidth/2,-37*window.innerWidth/96,-sence.fov).material({
                        image:imgs[i].bgUrl,
                        size:"80% 100%",
                        position:"left bottom",
                        repeat:"no-repeat"
                    }).update();
                    _p.property={
                        "id": i,
                        "row": "03"
                    };
                    $(_p.el).html("<p>"+imgs[i].text+"</P>");
                    G.planes.push(_p);
                    _sp.addChild(_p);
                    G.Sprites3.push(_sp);
                }
                return G.Sprites3;
            }
            var Sprites3 = createPlane3(planeData3);
           
            for(var i=0; i<Sprites3.length; i++){
                sence.addChild(Sprites3[i]);
            }
            
            // 隐藏第一组平面
            for(var i=0 ; i<Sprites1.length ; i++){
                // Sprites1[i].visibility({visible:false,alpha:0}).update();
            }
            // 隐藏第二组平面
            for(var i=0 ; i<Sprites2.length ; i++){
                Sprites2[i].visibility({visible:false,alpha:0}).update();
            }
            // 隐藏第三组界面
            for(var i=0 ;  i<Sprites3.length ; i++){
                Sprites3[i].visibility({visible:false,alpha:0}).update();
            }

            // 开始动画倒过去滚回来
            var startAnimation = function(planes) {
                for(var i=0; i<planes.length; i++){
                    (function(_p,planes){
                        // 需求确定：3秒走一圈的速度（不需要滚回来的动画）
                        JT.fromTo(_p, 3, {rotationY:_p.rotationY}, {  
                            rotationY: -360+_p.rotationY, Linear: JT.Linear.In, onUpdate: function () {  
                                // 此处因为是rotationY变化,只需要调用updateT()就可以,如果是alpha活visible变化,需要调用updateV(),材质变化调用updateM(),尺寸变化调用updateS()  
                                _p.updateT();  
                            },onEnd:function(){
                                // 将rotationY还原
                                _p.rotationY = _p.rotationY+360;
                                G.lock_startGame = true;
                            }  
                        });  
                    })(planes[i],planes);
                }
            };
            startAnimation(G.planes);

            // 抽奖动画
            var doLotteryAnimation = function() {

                for(var i=0; i<G.planes.length; i++){
                   (function(Plane){
                        JT.fromTo(Plane, 30, {rotationY:Plane.rotationY}, {  
                            rotationY: 1080+Plane.rotationY, ease: JT.Linear.In, onUpdate: function () {  
                                // 此处因为是rotationY变化,只需要调用updateT()就可以,如果是alpha活visible变化,需要调用updateV(),材质变化调用updateM(),尺寸变化调用updateS()  
                                Plane.updateT();  
                            },onEnd:function(){  
                                // _sp.removeChild(this);  
                            }  
                        });  
                   })(G.planes[i]);
               }
            };

            // 测试
            var myElement = document.getElementById('main');
           
            // by hammer.js
            var mc = new Hammer(myElement);

            // listen to events...
            // 【swipeleft】
            mc.on("swipeleft",function(){
               for(var i=0; i<G.planes.length; i++){
                   (function(Plane){
                        JT.fromTo(Plane, 30, {rotationY:Plane.rotationY}, {  
                            rotationY: -720+Plane.rotationY, ease: JT.Linear.In, onUpdate: function () {  
                                // 此处因为是rotationY变化,只需要调用updateT()就可以,如果是alpha活visible变化,需要调用updateV(),材质变化调用updateM(),尺寸变化调用updateS()  
                                Plane.updateT();  
                            },onEnd:function(){  
                                // _sp.removeChild(this);  
                            }  
                        });  
                   })(G.planes[i]);
               }
            });
            // 【swiperight】
            mc.on("swiperight",function(){
               for(var i=0; i<G.planes.length; i++){
                   (function(Plane){
                        JT.fromTo(Plane, 1, {rotationY:Plane.rotationY}, {  
                            rotationY: 10+Plane.rotationY, ease: JT.Linear.In, onUpdate: function () {  
                                // 此处因为是rotationY变化,只需要调用updateT()就可以,如果是alpha活visible变化,需要调用updateV(),材质变化调用updateM(),尺寸变化调用updateS()  
                                Plane.updateT();  
                            },onEnd:function(){  
                                // _sp.removeChild(this);  
                                console.log("1");
                            }  
                        });  
                   })(G.planes[i]);
               }
            });

            // 时间轴
            var timeLine = {
                // 时间点1：第一组平面的素材全部被第二组平面里面的素材替换的时间点
                'time_pl1BePl2' : false,
                // 时间点2：旋转停止，结果弹窗出现
                'time_popShow' : false,
                // 时间点3：旋转完三圈那刻，但是结果还没有出来
                'time_overNoResult': false
            };
            // 写时间点1
            var writeTime1 = function() {
                if(G.Sprites2[0].children[0].rotationY < 730){
                    return false;
                }
                return true;
            }
            // 写时间点3
            var writeTime3 = function() {
                if(G.Sprites3[0].children[0].rotationY < 1090 || G.result.isNull){
                    return false;
                }
                return true;
            }
            // 监视plane的旋转角度
            function go() {
                if(G.lock_startGame){
                    // 时间轴赋值
                    if(!timeLine.time_pl1BePl2){
                        timeLine.time_pl1BePl2 = writeTime1();
                    }else if(!timeLine.time_overNoResult){
                        timeLine.time_overNoResult = writeTime3();
                    }
                    // 前3圈的动画处理
                    for(var i=0 ; i<G.planes.length ; i++){
                        if( G.planes[i].rotationY%360 <= 90 && G.planes[i].rotationY%360 >= 85 && G.planes[i].property.row === "01"){
                            // 隐藏第一组平面里面的素材，显示第二组平面里面的素材
                            G.planes[i].parent.visibility({visible:false,alpha:0}).update();
                            G.Sprites2[G.planes[i].property.id].visibility({visible:true,alpha:1}).update();
                        }
                        if(timeLine.time_pl1BePl2 &&　G.planes[i].rotationY%360 <= 90 && G.planes[i].rotationY%360 >= 85　&& G.planes[i].property.row === "02"){
                            // console.log("验证正确！");
                            // 隐藏第二组平面里面的素材，显示第三组平面里面的素材
                            G.planes[i].parent.visibility({visible:false,alpha:0}).update();
                            G.Sprites3[G.planes[i].property.id].visibility({visible:true,alpha:1}).update();
                        }
                    }
                    // 请求超过3圈的特殊处理
                    if(timeLine.time_overNoResult){
                        //TODO
                        //......
                        console.log("执行了超过3圈的特殊处理");
                    }
                }

                requestAnimationFrame(go);
            }

            requestAnimationFrame(go);
            
            //响应屏幕调整尺寸
            function resize() {
                sence.size(window.innerWidth, window.innerHeight).update();
            }

            window.onresize = function () {
                resize();
            };
            resize();
        })(document, window);
    </script>
</body>
</html>
